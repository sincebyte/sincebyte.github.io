[{"authors":[],"categories":[],"content":"å¦‚ä½•æ’æŸ¥ï¼šjava.lang.OutOfMemoryError: unable to create native thread\njava.lang.OutOfMemoryError: unable to create native thread æµ‹è¯•ä»£ç  for (int i = 0; i \u0026lt; 3500; i++) { new Thread(() -\u0026gt; { try { try {Thread.sleep(5000L);} catch (InterruptedException e) {e.printStackTrace();} TimeUnit.HOURS.sleep(1); log.info(\u0026quot;\\n==== [log]: {} {}\u0026quot;, \u0026quot;sleep over\u0026quot;,Thread.currentThread().getName()); } catch (InterruptedException e) { e.printStackTrace(); } }).start(); } ç›¸å…³æŒ‡ä»¤ æŸ¥çœ‹è¿›ç¨‹çš„çº¿ç¨‹æ•°é‡\njstack -l PID | grep 'java.lang.Thread.State' | wc -l jstack -l PID | grep 'java.lang.Thread.State: RUNNABLE' | wc -l jstack -l PID | grep 'java.lang.Thread.State: TIMED_WAITING' | wc -l jstack -l PID | grep 'java.lang.Thread.State: WAITING' | wc -l jstack -l PID | grep 'java.lang.Thread.State:BLOCKED' | wc -l jstack -l PID | grep 'Java-level deadlock' | wc -l æŸ¥çœ‹è¿›ç¨‹çš„çº¿ç¨‹çŠ¶æ€\njstack -l PID | grep 'java.lang.Thread.State' æŸ¥çœ‹è¿›ç¨‹çš„çº¿ç¨‹ä¿¡æ¯\njstack -l PID è¿”å›ä¿¡æ¯ï¼Œå¯ä»¥çœ‹åˆ°é˜»å¡çš„ä»£ç ä¿¡æ¯\n\u0026quot;Thread-4050\u0026quot; #4136 prio=5 os_prio=31 cpu=1.00ms elapsed=546.19s tid=0x0000000130247000 nid=0x354103 waiting on condition [0x00000004b9a2e000] java.lang.Thread.State: TIMED_WAITING (sleeping) at java.lang.Thread.sleep(java.base@11.0.13/Native Method) at java.lang.Thread.sleep(java.base@11.0.13/Thread.java:334) at java.util.concurrent.TimeUnit.sleep(java.base@11.0.13/TimeUnit.java:446) at com.goldkinn.controller.CommentsController$$M$_jr_0E50A6F6C7FE22B0_1 .lambda$0(CommentsController.java:129) at com.goldkinn.controller.CommentsController$$Lambda$964$$M$_jr_0E50A6F6C7FE22B0_1 /0x0000000800e11c40.run(Unknown Source) at java.lang.Thread.run(java.base@11.0.13/Thread.java:829) ","permalink":"/posts/java-oom/","series":[],"tags":[],"title":"java æ ˆæº¢å‡ºé—®é¢˜æ’æŸ¥"},{"authors":[],"categories":[],"content":"RocketMQä¸»è¦ç”± Producerã€Brokerã€Consumer ä¸‰éƒ¨åˆ†ç»„æˆï¼Œå…¶ä¸­Producer è´Ÿè´£ç”Ÿäº§æ¶ˆæ¯ï¼ŒConsumer è´Ÿè´£æ¶ˆè´¹æ¶ˆæ¯ï¼ŒBroker è´Ÿè´£å­˜å‚¨æ¶ˆæ¯ã€‚\nç®€ä»‹ é¡¹ç›®åœ°å€ï¼šhttps://github.com/apache/rocketmq/tree/master\nRocketMQä¸»è¦ç”± Producerã€Brokerã€Consumer ä¸‰éƒ¨åˆ†ç»„æˆï¼Œå…¶ä¸­Producer è´Ÿè´£ç”Ÿäº§æ¶ˆæ¯ï¼ŒConsumer è´Ÿè´£æ¶ˆè´¹æ¶ˆæ¯ï¼ŒBroker è´Ÿè´£å­˜å‚¨æ¶ˆæ¯ã€‚Broker åœ¨å®é™…éƒ¨ç½²è¿‡ç¨‹ä¸­å¯¹åº”ä¸€å°æœåŠ¡å™¨ï¼Œæ¯ä¸ª Broker å¯ä»¥å­˜å‚¨å¤šä¸ªTopicçš„æ¶ˆæ¯ï¼Œæ¯ä¸ªTopicçš„æ¶ˆæ¯ä¹Ÿå¯ä»¥åˆ†ç‰‡å­˜å‚¨äºä¸åŒçš„ Brokerã€‚Message Queue ç”¨äºå­˜å‚¨æ¶ˆæ¯çš„ç‰©ç†åœ°å€ï¼Œæ¯ä¸ªTopicä¸­çš„æ¶ˆæ¯åœ°å€å­˜å‚¨äºå¤šä¸ª Message Queue ä¸­ã€‚ConsumerGroup ç”±å¤šä¸ªConsumer å®ä¾‹æ„æˆã€‚\næ¶ˆæ¯çš„å‘å¸ƒæ˜¯æŒ‡æŸä¸ªç”Ÿäº§è€…å‘æŸä¸ªtopicå‘é€æ¶ˆæ¯ï¼›æ¶ˆæ¯çš„è®¢é˜…æ˜¯æŒ‡æŸä¸ªæ¶ˆè´¹è€…å…³æ³¨äº†æŸä¸ªtopicä¸­å¸¦æœ‰æŸäº›tagçš„æ¶ˆæ¯ï¼Œè¿›è€Œä»è¯¥topicæ¶ˆè´¹æ•°æ®ã€‚\næ¶æ„ NameServeræ˜¯ä¸€ä¸ªå‡ ä¹æ— çŠ¶æ€èŠ‚ç‚¹ï¼Œå¯é›†ç¾¤éƒ¨ç½²ï¼ŒèŠ‚ç‚¹ä¹‹é—´æ— ä»»ä½•ä¿¡æ¯åŒæ­¥ã€‚\nBrokeréƒ¨ç½²ç›¸å¯¹å¤æ‚ï¼ŒBrokeråˆ†ä¸ºMasterä¸Slaveï¼Œä¸€ä¸ªMasterå¯ä»¥å¯¹åº”å¤šä¸ªSlaveï¼Œä½†æ˜¯ä¸€ä¸ªSlaveåªèƒ½å¯¹åº”ä¸€ä¸ªMasterï¼ŒMasterä¸Slave çš„å¯¹åº”å…³ç³»é€šè¿‡æŒ‡å®šç›¸åŒçš„BrokerNameï¼Œä¸åŒçš„BrokerId æ¥å®šä¹‰ï¼ŒBrokerIdä¸º0è¡¨ç¤ºMasterï¼Œé0è¡¨ç¤ºSlaveã€‚Masterä¹Ÿå¯ä»¥éƒ¨ç½²å¤šä¸ªã€‚æ¯ä¸ªBrokerä¸NameServeré›†ç¾¤ä¸­çš„æ‰€æœ‰èŠ‚ç‚¹å»ºç«‹é•¿è¿æ¥ï¼Œå®šæ—¶æ³¨å†ŒTopicä¿¡æ¯åˆ°æ‰€æœ‰NameServerã€‚ æ³¨æ„ï¼šå½“å‰RocketMQç‰ˆæœ¬åœ¨éƒ¨ç½²æ¶æ„ä¸Šæ”¯æŒä¸€Masterå¤šSlaveï¼Œä½†åªæœ‰BrokerId=1çš„ä»æœåŠ¡å™¨æ‰ä¼šå‚ä¸æ¶ˆæ¯çš„è¯»è´Ÿè½½ã€‚\nProducerä¸NameServeré›†ç¾¤ä¸­çš„å…¶ä¸­ä¸€ä¸ªèŠ‚ç‚¹ï¼ˆéšæœºé€‰æ‹©ï¼‰å»ºç«‹é•¿è¿æ¥ï¼Œå®šæœŸä»NameServerè·å–Topicè·¯ç”±ä¿¡æ¯ï¼Œå¹¶å‘æä¾›Topic æœåŠ¡çš„Masterå»ºç«‹é•¿è¿æ¥ï¼Œä¸”å®šæ—¶å‘Masterå‘é€å¿ƒè·³ã€‚Producerå®Œå…¨æ— çŠ¶æ€ï¼Œå¯é›†ç¾¤éƒ¨ç½²ã€‚\nConsumerä¸NameServeré›†ç¾¤ä¸­çš„å…¶ä¸­ä¸€ä¸ªèŠ‚ç‚¹ï¼ˆéšæœºé€‰æ‹©ï¼‰å»ºç«‹é•¿è¿æ¥ï¼Œå®šæœŸä»NameServerè·å–Topicè·¯ç”±ä¿¡æ¯ï¼Œå¹¶å‘æä¾›TopicæœåŠ¡çš„Masterã€Slaveå»ºç«‹é•¿è¿æ¥ï¼Œä¸”å®šæ—¶å‘Masterã€Slaveå‘é€å¿ƒè·³ã€‚Consumeræ—¢å¯ä»¥ä»Masterè®¢é˜…æ¶ˆæ¯ï¼Œä¹Ÿå¯ä»¥ä»Slaveè®¢é˜…æ¶ˆæ¯ï¼Œæ¶ˆè´¹è€…åœ¨å‘Masteræ‹‰å–æ¶ˆæ¯æ—¶ï¼ŒMasteræœåŠ¡å™¨ä¼šæ ¹æ®æ‹‰å–åç§»é‡ä¸æœ€å¤§åç§»é‡çš„è·ç¦»ï¼ˆåˆ¤æ–­æ˜¯å¦è¯»è€æ¶ˆæ¯ï¼Œäº§ç”Ÿè¯»I/Oï¼‰ï¼Œä»¥åŠä»æœåŠ¡å™¨æ˜¯å¦å¯è¯»ç­‰å› ç´ å»ºè®®ä¸‹ä¸€æ¬¡æ˜¯ä»Masterè¿˜æ˜¯Slaveæ‹‰å–ã€‚\nRocketMQæ¶æ„ä¸Šä¸»è¦åˆ†ä¸ºå››éƒ¨åˆ†ï¼Œå¦‚ä¸Šå›¾æ‰€ç¤º:\nProducerï¼šæ¶ˆæ¯å‘å¸ƒçš„è§’è‰²ï¼Œæ”¯æŒåˆ†å¸ƒå¼é›†ç¾¤æ–¹å¼éƒ¨ç½²ã€‚Produceré€šè¿‡MQçš„è´Ÿè½½å‡è¡¡æ¨¡å—é€‰æ‹©ç›¸åº”çš„Brokeré›†ç¾¤é˜Ÿåˆ—è¿›è¡Œæ¶ˆæ¯æŠ•é€’ï¼ŒæŠ•é€’çš„è¿‡ç¨‹æ”¯æŒå¿«é€Ÿå¤±è´¥å¹¶ä¸”ä½å»¶è¿Ÿã€‚\nConsumerï¼šæ¶ˆæ¯æ¶ˆè´¹çš„è§’è‰²ï¼Œæ”¯æŒåˆ†å¸ƒå¼é›†ç¾¤æ–¹å¼éƒ¨ç½²ã€‚æ”¯æŒä»¥pushæ¨ï¼Œpullæ‹‰ä¸¤ç§æ¨¡å¼å¯¹æ¶ˆæ¯è¿›è¡Œæ¶ˆè´¹ã€‚åŒæ—¶ä¹Ÿæ”¯æŒé›†ç¾¤æ–¹å¼å’Œå¹¿æ’­æ–¹å¼çš„æ¶ˆè´¹ï¼Œå®ƒæä¾›å®æ—¶æ¶ˆæ¯è®¢é˜…æœºåˆ¶ï¼Œå¯ä»¥æ»¡è¶³å¤§å¤šæ•°ç”¨æˆ·çš„éœ€æ±‚ã€‚\nNameServerï¼šNameServeræ˜¯ä¸€ä¸ªéå¸¸ç®€å•çš„Topicè·¯ç”±æ³¨å†Œä¸­å¿ƒï¼Œå…¶è§’è‰²ç±»ä¼¼Dubboä¸­çš„zookeeperï¼Œæ”¯æŒBrokerçš„åŠ¨æ€æ³¨å†Œä¸å‘ç°ã€‚ä¸»è¦åŒ…æ‹¬ä¸¤ä¸ªåŠŸèƒ½ï¼šBrokerç®¡ç†ï¼ŒNameServeræ¥å—Brokeré›†ç¾¤çš„æ³¨å†Œä¿¡æ¯å¹¶ä¸”ä¿å­˜ä¸‹æ¥ä½œä¸ºè·¯ç”±ä¿¡æ¯çš„åŸºæœ¬æ•°æ®ã€‚ç„¶åæä¾›å¿ƒè·³æ£€æµ‹æœºåˆ¶ï¼Œæ£€æŸ¥Brokeræ˜¯å¦è¿˜å­˜æ´»ï¼›è·¯ç”±ä¿¡æ¯ç®¡ç†ï¼Œæ¯ä¸ªNameServerå°†ä¿å­˜å…³äºBrokeré›†ç¾¤çš„æ•´ä¸ªè·¯ç”±ä¿¡æ¯å’Œç”¨äºå®¢æˆ·ç«¯æŸ¥è¯¢çš„é˜Ÿåˆ—ä¿¡æ¯ã€‚ç„¶åProducerå’ŒConumseré€šè¿‡NameServerå°±å¯ä»¥çŸ¥é“æ•´ä¸ªBrokeré›†ç¾¤çš„è·¯ç”±ä¿¡æ¯ï¼Œä»è€Œè¿›è¡Œæ¶ˆæ¯çš„æŠ•é€’å’Œæ¶ˆè´¹ã€‚NameServeré€šå¸¸ä¹Ÿæ˜¯é›†ç¾¤çš„æ–¹å¼éƒ¨ç½²ï¼Œå„å®ä¾‹é—´ç›¸äº’ä¸è¿›è¡Œä¿¡æ¯é€šè®¯ã€‚Brokeræ˜¯å‘æ¯ä¸€å°NameServeræ³¨å†Œè‡ªå·±çš„è·¯ç”±ä¿¡æ¯ï¼Œæ‰€ä»¥æ¯ä¸€ä¸ªNameServerå®ä¾‹ä¸Šé¢éƒ½ä¿å­˜ä¸€ä»½å®Œæ•´çš„è·¯ç”±ä¿¡æ¯ã€‚å½“æŸä¸ªNameServerå› æŸç§åŸå› ä¸‹çº¿äº†ï¼ŒBrokerä»ç„¶å¯ä»¥å‘å…¶å®ƒNameServeråŒæ­¥å…¶è·¯ç”±ä¿¡æ¯ï¼ŒProducerå’ŒConsumerä»ç„¶å¯ä»¥åŠ¨æ€æ„ŸçŸ¥Brokerçš„è·¯ç”±çš„ä¿¡æ¯ã€‚\nBrokerServerï¼šBrokerä¸»è¦è´Ÿè´£æ¶ˆæ¯çš„å­˜å‚¨ã€æŠ•é€’å’ŒæŸ¥è¯¢ä»¥åŠæœåŠ¡é«˜å¯ç”¨ä¿è¯ï¼Œä¸ºäº†å®ç°è¿™äº›åŠŸèƒ½ï¼ŒBrokeråŒ…å«äº†ä»¥ä¸‹å‡ ä¸ªé‡è¦å­æ¨¡å—ã€‚\nRemoting Moduleï¼šæ•´ä¸ªBrokerçš„å®ä½“ï¼Œè´Ÿè´£å¤„ç†æ¥è‡ªClientç«¯çš„è¯·æ±‚ã€‚ Client Managerï¼šè´Ÿè´£ç®¡ç†å®¢æˆ·ç«¯(Producer/Consumer)å’Œç»´æŠ¤Consumerçš„Topicè®¢é˜…ä¿¡æ¯ã€‚ Store Serviceï¼šæä¾›æ–¹ä¾¿ç®€å•çš„APIæ¥å£å¤„ç†æ¶ˆæ¯å­˜å‚¨åˆ°ç‰©ç†ç¡¬ç›˜å’ŒæŸ¥è¯¢åŠŸèƒ½ã€‚ HA Serviceï¼šé«˜å¯ç”¨æœåŠ¡ï¼Œæä¾›Master Broker å’Œ Slave Brokerä¹‹é—´çš„æ•°æ®åŒæ­¥åŠŸèƒ½ã€‚ Index Serviceï¼šæ ¹æ®ç‰¹å®šçš„Message keyå¯¹æŠ•é€’åˆ°Brokerçš„æ¶ˆæ¯è¿›è¡Œç´¢å¼•æœåŠ¡ï¼Œä»¥æä¾›æ¶ˆæ¯çš„å¿«é€ŸæŸ¥è¯¢ã€‚ éƒ¨ç½² ç»“åˆéƒ¨ç½²æ¶æ„å›¾ï¼Œæè¿°é›†ç¾¤å·¥ä½œæµç¨‹ï¼š\nå¯åŠ¨NameServerï¼ŒNameServerèµ·æ¥åç›‘å¬ç«¯å£ï¼Œç­‰å¾…Brokerã€Producerã€Consumerè¿ä¸Šæ¥ï¼Œç›¸å½“äºä¸€ä¸ªè·¯ç”±æ§åˆ¶ä¸­å¿ƒã€‚ Brokerå¯åŠ¨ï¼Œè·Ÿæ‰€æœ‰çš„NameServerä¿æŒé•¿è¿æ¥ï¼Œå®šæ—¶å‘é€å¿ƒè·³åŒ…ã€‚å¿ƒè·³åŒ…ä¸­åŒ…å«å½“å‰Brokerä¿¡æ¯(IP+ç«¯å£ç­‰)ä»¥åŠå­˜å‚¨æ‰€æœ‰Topicä¿¡æ¯ã€‚æ³¨å†ŒæˆåŠŸåï¼ŒNameServeré›†ç¾¤ä¸­å°±æœ‰Topicè·ŸBrokerçš„æ˜ å°„å…³ç³»ã€‚ æ”¶å‘æ¶ˆæ¯å‰ï¼Œå…ˆåˆ›å»ºTopicï¼Œåˆ›å»ºTopicæ—¶éœ€è¦æŒ‡å®šè¯¥Topicè¦å­˜å‚¨åœ¨å“ªäº›Brokerä¸Šï¼Œä¹Ÿå¯ä»¥åœ¨å‘é€æ¶ˆæ¯æ—¶è‡ªåŠ¨åˆ›å»ºTopicã€‚ Producerå‘é€æ¶ˆæ¯ï¼Œå¯åŠ¨æ—¶å…ˆè·ŸNameServeré›†ç¾¤ä¸­çš„å…¶ä¸­ä¸€å°å»ºç«‹é•¿è¿æ¥ï¼Œå¹¶ä»NameServerä¸­è·å–å½“å‰å‘é€çš„Topicå­˜åœ¨å“ªäº›Brokerä¸Šï¼Œè½®è¯¢ä»é˜Ÿåˆ—åˆ—è¡¨ä¸­é€‰æ‹©ä¸€ä¸ªé˜Ÿåˆ—ï¼Œç„¶åä¸é˜Ÿåˆ—æ‰€åœ¨çš„Brokerå»ºç«‹é•¿è¿æ¥ä»è€Œå‘Brokerå‘æ¶ˆæ¯ã€‚ Consumerè·ŸProducerç±»ä¼¼ï¼Œè·Ÿå…¶ä¸­ä¸€å°NameServerå»ºç«‹é•¿è¿æ¥ï¼Œè·å–å½“å‰è®¢é˜…Topicå­˜åœ¨å“ªäº›Brokerä¸Šï¼Œç„¶åç›´æ¥è·ŸBrokerå»ºç«‹è¿æ¥é€šé“ï¼Œå¼€å§‹æ¶ˆè´¹æ¶ˆæ¯ã€‚ å•èŠ‚ç‚¹éƒ¨ç½² è®¾ç½®ç¯å¢ƒå˜é‡ 1 set -x ROCKETMQ_HOME /Users/van/soft/rocketMQ ä¸‹è½½é¡¹ç›®è‡³ROCKETMQ_HOMEæ–‡ä»¶ç›®å½•ï¼Œ\nhttps://github.com/apache/rocketmq/tree/master\nä¸‹è½½é¡¹ç›®è‡³ROCKETMQ_HOMEæ–‡ä»¶ç›®å½•ï¼Œ\nhttps://github.com/apache/rocketmq-dashboard\nå¯åŠ¨NameServer 1 nohup sh $ROCKETMQ_HOME/rocketmq-4.9.3/bin/mqnamesrv \u0026amp; 2 tail -f ~/logs/rocketmqlogs/namesrv.log 3 jps å¯åŠ¨borkerServer 1 nohup sh $ROCKETMQ_HOME/rocketmq-4.9.3/bin/mqbroker -n localhost:9876 \u0026amp; 2 tail -f ~/logs/rocketmqlogs/broker.log 3 jps å¯åŠ¨ç®¡ç†ç«¯ é¡¹ç›®åœ°å€ï¼šhttps://github.com/apache/rocketmq-dashboard\nä¿®æ”¹nameserveråœ°å€ï¼Œapplication.yml\n1 ... 2 namesrvAddrs: 3 - 127.0.0.1:9876 4 ... å¯åŠ¨å‘½ä»¤\nmvn springboot:run è®¿é—®åœ°å€ï¼šhttp://localhost:8080/#/topic\næ¶ˆæ¯å‘é€å’Œæ¶ˆè´¹æµ‹è¯• 1 #bash 2 export NAMESRV_ADDR=localhost:9876 3 #fish 4 set -x NAMESRV_ADDR localhost:9876 5 sh $ROCKETMQ_HOME/rocketmq-4.9.3/bin/tools.sh org.apache.rocketmq.example.quickstart.Producer 6 sh $ROCKETMQ_HOME/rocketmq-4.9.3/bin/tools.sh org.apache.rocketmq.example.quickstart.Consumer å¤åˆ¶å’Œåˆ·ç›˜ç­–ç•¥ å¤åˆ¶ç­–ç•¥ï¼šåŒæ­¥å¤åˆ¶ã€å¼‚æ­¥å¤åˆ¶ï¼Œbroker masterä¸ slaver ä¹‹é—´æ•°æ®åŒæ­¥ç­–ç•¥\nåˆ·ç›˜ç­–ç•¥ï¼šåŒæ­¥åˆ·ç›˜ã€å¼‚æ­¥åˆ·ç›˜ï¼Œå¼‚æ­¥åˆ·ç›˜ä¸€èˆ¬æ˜¯å°†æ•°æ®å­˜å‚¨è‡³pageCache,è¾¾åˆ°ä¸€å®šæ•°é‡æ—¶è‡ªåŠ¨è¿›è¡Œè½ç›˜\nblocker é›†ç¾¤æ¨¡å¼ å•Master åªæœ‰ä¸€ä¸ªblockerï¼Œåªèƒ½åœ¨æµ‹è¯•æ—¶ä½¿ç”¨ï¼Œæœ‰å•ç‚¹æ•…éšœ\nå¤šMaster brokerä»…ç”±å¤šä¸ªmasteræ„æˆï¼Œä¸å­˜åœ¨slaverã€‚åŒä¸€ä¸ªtopicçš„å„ä¸ªqueueä¼šå¹³å‡åˆ†å¸ƒè‡³å¤šä¸ªmasterèŠ‚ç‚¹ã€‚\nä¼˜ç‚¹ï¼šé…ç½®ç®€å•ã€å•ä¸ªmasterå®•æœºå¯¹é›†ç¾¤æ²¡å½±å“ã€‚å‰ææ˜¯éœ€è¦é…ç½®ç£ç›˜é˜µåˆ—ã€‚raidç£ç›˜é˜µåˆ—çš„æ•ˆç‡è¦é«˜äºmaster-slaveré›†ç¾¤ï¼Œraidæ˜¯ç¡¬ä»¶æ”¯æŒï¼Œæˆæœ¬è¾ƒé«˜ã€‚\nç¼ºç‚¹ï¼šæœªæ¢å¤ä¹‹å‰ï¼Œè¯¥æœºå™¨ä¸Šçš„æ¶ˆæ¯ä¸èƒ½è¢«æ¶ˆè´¹ï¼Œæ¶ˆæ¯æ—¶æ—¶æ€§ä¼šå—åˆ°å½±å“ã€‚\nå¤šMasterå¤šSlaver-å¼‚æ­¥å¤åˆ¶ masterä¸slaverä¹‹é—´æ˜¯ä¸»å¤‡å…³ç³»ï¼Œå³masterè´Ÿè´£æ¶ˆæ¯çš„è¯»å†™è¯·æ±‚ï¼Œè€Œslaverä»…è´Ÿè´£æ¶ˆæ¯çš„å¤‡ä»½ï¼Œmaterå®•æœºåçš„è§’è‰²è‡ªåŠ¨åˆ‡æ¢ã€‚\nç”±äºæ˜¯å¼‚æ­¥è´Ÿè´£ï¼Œåœ¨åˆ‡æ¢è¿‡ç¨‹ä¸­å¯èƒ½ä¼šæ¶‰åŠå°‘é‡æ¶ˆæ¯ä¸¢å¤±ã€‚å–å†³äºmasterå‘slaveråŒæ­¥æ•°æ®çš„æ—¶æœºã€‚\nå¤šMasterå¤šSlaver-åŒæ­¥åŒå†™ æ¶ˆæ¯å†™å…¥masteråï¼Œç­‰å¾…masterå°†ä¿¡æ¯åŒæ­¥è‡³slaveræˆåŠŸåï¼Œè¿”å›æˆåŠŸã€‚\nä¼˜ç‚¹ï¼šä¸å­˜åœ¨ä¸¢å¤±\nç¼ºç‚¹ï¼šå•ä¸ªæ¶ˆæ¯çš„RTé«˜ï¼Œå¯¼è‡´æ€§èƒ½è¦ç•¥ä½ï¼ˆçº¦10%ï¼‰ï¼Œmasterå®•æœºåä¸ä¼šè‡ªåŠ¨åˆ‡æ¢è‡³slaverã€‚\nRocketMqå·¥ä½œåŸç† æ¶ˆæ¯çš„ç”Ÿäº§è¿‡ç¨‹ Producerå‘é€æ¶ˆæ¯ä¹‹å‰ï¼Œä¼šå…ˆå‘nameserverè¯·æ±‚æ¶ˆæ¯topicçš„è·¯ç”±ä¿¡æ¯ nameserverè¿”å›è¯¥topicçš„è·¯ç”±è¡¨å’Œbrokeråˆ—è¡¨\nè·¯ç”±è¡¨ï¼šmapï¼Œkeyä¸ºtopicåç§°ã€valueæ˜¯ä¸€ä¸ªqueueDataå®ä¾‹åˆ—è¡¨ï¼Œå³åªè¦æ¶‰åŠåˆ°è¯¥topicçš„brokerï¼Œä¸€ä¸ªbrokerå¯¹åº”ä¸€ä¸ªqueue,Queuedataä¸­åŒ…å«brokerNameã€‚ç®€å•æ¥è¯´ï¼Œè·¯ç”±è¡¨çš„valueä¸ºæ‰€æœ‰æ¶‰åŠè¯¥topicçš„brokerName\nrouterMap\u0026lt;topicName,List\u0026gt;,queueData: brokerName\nBorkeråˆ—è¡¨ï¼šMap\u0026lt;brokerNameã€brokerDataMap\u0026gt;, brokerDataMap\u0026lt;brokerId,brokerIp\u0026gt; Produceræ ¹æ®æ¶ˆæ¯çš„é€‰æ‹©ç­–ç•¥ï¼Œä»queueåˆ—è¡¨ä¸­é€‰å‡ºä¸€ä¸ªé˜Ÿåˆ—ï¼Œç”¨äºåç»­å­˜å‚¨æ¶ˆæ¯ Producerå¯¹æ¶ˆæ¯åšä¸€äº›ç‰¹æ®Šå‡ºç†ï¼Œä¾‹å¦‚æ¶ˆæ¯è¶…è¿‡4Mï¼Œå¯¹æ¶ˆæ¯è¿›è¡Œå‹ç¼© producerå‘é€‰æ‹©å‡ºçš„queueæ‰€åœ¨çš„brokerå‘å‡ºrpcè¯·æ±‚ï¼Œå°†æ¶ˆæ¯å‘é€åˆ°é€‰æ‹©å‡ºçš„queue queueé€‰æ‹©ç®—æ³• è½®è¯¢ç®—æ³•ï¼Œæ¯ä¸ªqueueå¯å‡åŒ€æ”¶åˆ°æ¶ˆæ¯ï¼Œç”±äºéœ€è¦ç­‰åˆ°æŠ•é€’æˆåŠŸåæ‰èƒ½è¿›è¡Œä¸‹ä¸ªèŠ‚ç‚¹çš„è½®è¯¢ï¼Œå› æ­¤è¯¥ç®—æ³•å­˜åœ¨åœ¨ç”Ÿäº§è€…ç«¯æ¶ˆæ¯ç§¯å‹é—®é¢˜ï¼Œå½±å“æ¶ˆæ¯çš„æŠ•é€’æ€§èƒ½ã€‚ æœ€å°æŠ•é€’å»¶è¿Ÿç®—æ³•ï¼Œå°†æ¶ˆæ¯æŠ•é€’è‡³å»¶è¿Ÿæœ€å°çš„queue,å¯æœ‰æ•ˆæå‡æ¶ˆæ¯çš„æŠ•é€’æ€§èƒ½ã€‚é—®é¢˜æ˜¯å¯èƒ½å‡ºç°å•æœºè¿‡çƒ­ï¼Œæ¶ˆæ¯åˆ†é…ä¸å‡ã€‚ æ¶ˆæ¯å­˜å‚¨ æ•°æ®å­˜å‚¨åœ¨home/storeç›®å½•ä¸‹ï¼Œè¯¥ç›®å½•åœ¨å¯åŠ¨æ—¶åˆ›å»ºï¼Œæ­£å¸¸å…³é—­brokerè¯¥æ¶ˆæ¯ä¼šè‡ªåŠ¨æ¶ˆå¤±ï¼Œå¦‚æœå¯åŠ¨å‰å‘ç°æ­¤æ–‡ä»¶å­˜åœ¨ï¼Œåˆ™è¯´æ˜ä¹‹å‰æ˜¯éæ­£å¸¸å…³é—­ã€‚ å…¶ä¸­å­˜å‚¨ç€commitlogæ–‡ä»¶ï¼Œè€Œæ¶ˆæ¯æ˜¯å†™åœ¨commitlogæ–‡ä»¶ä¸­çš„ configç›®å½•ï¼Œå­˜æ”¾ç€brokerè¿è¡ŒæœŸé—´çš„ä¸€äº›é…ç½®æ•°æ® consumequeue, å­˜å‚¨ç€æ¶ˆè´¹é˜Ÿåˆ— indexå­˜å‚¨ç€æ¶ˆæ¯ç´¢å¼•æ–‡ä»¶ lock:è¿è¡ŒæœŸé—´ä½¿ç”¨åˆ°çš„å…¨å±€èµ„æºé” commitlogæ–‡ä»¶ åç§»é‡ ç´¢å¼•æ–‡ä»¶ Reblance æ²¡æ¬¡æ–°å¢æˆ–è€…åˆ é™¤æ¶ˆè´¹è€…çš„æ—¶å€™éƒ½ä¼šè§¦å‘reblanceï¼Œreblanceä¼šå¯¼è‡´æ¶ˆæ¯ç§¯å‹å’Œæ¶ˆæ¯é‡å¤æ¶ˆè´¹çš„é—®é¢˜ã€‚\nå¦å¤–å¦‚æœæ¶ˆè´¹è€…æ•°é‡å¤§äºqueueæ—¶ï¼Œæ¶ˆæ¯åªä¼šè´Ÿè½½è‡³æœ‰é™çš„æ¶ˆè´¹è€…ï¼Œè¿™ä¸ªå«reblanceçš„é™åˆ¶\n","permalink":"/posts/rocketmqintroduction/","series":[],"tags":[],"title":"RocketMQ å¿…é¡»çŸ¥é“çš„ç†è®ºçŸ¥è¯†"},{"authors":[],"categories":[],"content":"ä½¿ç”¨ Emacs å¯¼å‡º html æ ·å¼ï¼Œç±»ä¼¼äº doom emacs doc çš„ css style\næ ·å¼å¼•ç”¨ï¼šhttps://docs.doomemacs.org/latest/#/modules\nä¸€ä¸ªç±» doom doc çš„ org html æ ·å¼æ¨¡ç‰ˆ ç‚¹æ­¤é¢„è§ˆğŸª„\nä½¿ç”¨ é…ç½® snippet æ¨¡ç‰ˆï¼Œç„¶ååœ¨ org mode æ–‡ä»¶ä¸­ä½¿ç”¨ tt tab å°±å¯å±•å¼€æ­¤æ¨¡ç‰ˆã€‚\n# -*- mode: snippet -*- # name: title # key: tt # -- #+title: `(file-name-sans-extension (buffer-name))` #+SUBTITLE: this is subtitle #+AUTHOR: autor #+HTML_HEAD: \u0026lt;script src=\u0026quot;scroll.js\u0026quot;\u0026gt;\u0026lt;/script\u0026gt; #+HTML_HEAD: \u0026lt;link rel=\u0026quot;stylesheet\u0026quot; type=\u0026quot;text/css\u0026quot; href=\u0026quot;org_css.css\u0026quot;/\u0026gt; #+HTML_HEAD: \u0026lt;script src=\u0026quot;https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js\u0026quot;\u0026gt;\u0026lt;/script\u0026gt; #+OPTIONS: prop:nil timestamp:t \\n:t ^:nil f:t toc:t author:t num:t H:2 #+LATEX_COMPILER: xelatex #+LATEX_CLASS: elegantpaper #+MACRO: htmlred @@html:\u0026lt;font color=\u0026quot;red\u0026quot;\u0026gt;\u0026lt;/font\u0026gt;@@ #+MACRO: latexred @@latex:{\\color{red}@@@@latex:}@@ #+latex:\\newpage æƒ³ä½¿ç”¨åœ¨çº¿ç‰ˆçš„é™æ€æ–‡ä»¶ï¼Œå¯ä»¥ä½¿ç”¨ä¸‹é¢çš„é…ç½®è¿›è¡Œæ›¿æ¢\n#+HTML_HEAD: \u0026lt;link href=\u0026quot;https://emacs-1308440781.cos.ap-chengdu.myqcloud.com/org_css.css\u0026quot; rel=\u0026quot;stylesheet\u0026quot;\u0026gt;\u0026lt;/link\u0026gt; #+HTML_HEAD: \u0026lt;script src=\u0026quot;https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js\u0026quot;\u0026gt;\u0026lt;/script\u0026gt; #+HTML_HEAD: \u0026lt;script src=\u0026quot;https://emacs-1308440781.cos.ap-chengdu.myqcloud.com/scroll.js\u0026quot;\u0026gt;\u0026lt;/script\u0026gt; å­—ä½“æ ·å¼ Table 1: å­—ä½“æ ·å¼è¯´æ˜ ç²—ä½“ bold æ–œä½“ italic ä¸‹åˆ’çº¿ underlined ä¸­æ¨ªçº¿ strike-through ä»£ç ï¼ŒæŒ‰é”® code ç‰¹æ®Šè¯´æ˜ quote æ‘˜è¦ã€å¼•ç”¨ å¯ä½¿ç”¨`quote`æ¥è¿›è¡Œä»£ç å—è¡¥å…¨ï¼Œè¡¨ç¤ºæ‘˜è¦ï¼Œå¼•ç”¨\nTECO - Tape [later text] Editor/COrrector\nA combination text editor/really horrible ProgrammingLanguage. To quote the paper â€œRealProgrammers donâ€™t use Pascalâ€ (1983):\nnotice æ³¨æ„äº‹é¡¹ã€æé†’ ä½ æœ‰è®¸å¤šå·²æ ‡è®°çš„é¡¹ç›®å¹¶ä¸”ä½ å¯èƒ½é”™è¿‡ä¸€ä¸ªé‡è¦çš„é¡¹ç›®æ—¶ï¼Œæé†’å¯ä»¥æä¾›å¸®åŠ©\nPlease do not file or answer Doom Emacs issues on Reddit, Twitter, or StackOverflow. Kindly refer them to this section.\nè¿™æ˜¯ 1 ä¸ªä¾‹å­\næ®µè½åŠé«˜äº® Example of an comment.\nåŸæ–‡ï¼šç”¨å‹ bip äº§å“åŠŸèƒ½è¯´æ˜ ï¼Œåœ¨è¯´æ˜æ–‡æ¡£\nå¤§æ•°æ®ä¸­ æœ€å®è´µ ã€æœ€éš¾ä»¥ä»£æ›¿çš„å°±æ˜¯æ•°æ®ï¼Œä¸€åˆ‡éƒ½å›´ç»•æ•°æ®ã€‚\nHDFS æ˜¯æœ€æ—©çš„å¤§æ•°æ®å­˜å‚¨ç³»ç»Ÿï¼Œå­˜å‚¨ç€å®è´µçš„æ•°æ®èµ„äº§ï¼Œå„ç§æ–°ç®—æ³•ã€æ¡†æ¶è¦æƒ³å¾—åˆ°å¹¿æ³›ä½¿ç”¨ï¼Œå¿…é¡»æ”¯æŒ HDFSï¼Œæ‰èƒ½è·å–å·²å­˜å‚¨åœ¨é‡Œé¢çš„æ•°æ®ã€‚æ‰€ä»¥å¤§æ•°æ®æŠ€æœ¯è¶Šå‘å±•ï¼Œæ–°æŠ€æœ¯è¶Šå¤šï¼ŒHDFS å¾—åˆ°çš„æ”¯æŒè¶Šå¤šï¼Œè¶Šç¦»ä¸å¼€ HDFSã€‚HDFS ä¹Ÿè®¸ä¸æ˜¯æœ€å¥½çš„å¤§æ•°æ®å­˜å‚¨æŠ€æœ¯ï¼Œä½†ä¾ç„¶æ˜¯æœ€é‡è¦çš„å¤§æ•°æ®å­˜å‚¨æŠ€æœ¯ã€‚\nHDFS æ˜¯å¦‚ä½•å®ç°å¤§æ•°æ®é«˜é€Ÿã€å¯é çš„å­˜å‚¨å’Œè®¿é—®çš„å‘¢ï¼Ÿ\nHadoop åˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿ HDFS çš„è®¾è®¡ç›®æ ‡æ˜¯ç®¡ç†æ•°ä»¥åƒè®¡çš„æœåŠ¡å™¨ã€æ•°ä»¥ä¸‡è®¡çš„ç£ç›˜ï¼Œå°†å¤§è§„æ¨¡çš„æœåŠ¡å™¨è®¡ç®—èµ„æºå½“ä½œä¸€ä¸ªå•ä¸€å­˜å‚¨ç³»ç»Ÿè¿›è¡Œç®¡ç†ï¼Œå¯¹åº”ç”¨ç¨‹åºæä¾›æ•°ä»¥ PB è®¡çš„å­˜å‚¨å®¹é‡ï¼Œè®©åº”ç”¨ç¨‹åºåƒä½¿ç”¨æ™®é€šæ–‡ä»¶ç³»ç»Ÿä¸€æ ·å­˜å‚¨å¤§è§„æ¨¡çš„æ–‡ä»¶æ•°æ®ã€‚ è¡¨æ ¼ C-c ~ to convert to tabel.el table\nC-c ~ to convert to org table\norg table M-h M-l for move Columns left and right\norg table M-k M-j for move Rows up and down\n# table.el for merge Columns or Rows Table 2: square N N^2 N^3 N^4 sqrt(n) sqrt[4](N) 1 1 1 1 1 1 2 4 8 16 1.4142136 1.1892071 3 9 27 81 1.7320508 1.3160740 Table 3: student Student Prob 1 Prob 2 Prob 3 Total Note Maximum 10 15 25 50 10.0 Peter 10 8 23 41 8.2 Sam 2 4 3 9 1.8 Average \u0026#xa0; \u0026#xa0; \u0026#xa0; 25.0 \u0026#xa0; Table 4: long table Format Fine-grained-control Initial Effort Syntax simplicity Editor Support Integrations Ease-of-referencing Versatility Word Word^2 Word^3 Word^4 sqrt(Word) sqrt(sqrt(Word)) 2 2 LaTeX LaTeX^2 LaTeX^3 LaTeX^4 sqrt(LaTeX) sqrt(sqrt(LaTeX)) 4 3 Org Mode Org^2 Mode^2 Org^3 Mode^3 Org^4 Mode^4 sqrt(Org Mode) sqrt(sqrt(Org Mode)) 4 4 Markdown Markdown^2 Markdown^3 Markdown^4 sqrt(Markdown) sqrt(sqrt(Markdown)) 3 1 Markdown + Pandoc (Markdown + Pandoc)^2 (Markdown + Pandoc)^3 (Markdown + Pandoc)^4 sqrt(Markdown + Pandoc) sqrt(sqrt(Markdown + Pandoc)) 3 2 awk è¡¨æ ¼ aardvark 555-5553 1200/300 B alpo-net 555-3412 2400/1200/300 A barfly 555-7685 1200/300 A bites 555-1675 2400/1200/300 A camelot 555-0542 300 C core 555-2912 1200/300 C fooey 555-1234 2400/1200/300 B foot 555-6699 1200/300 B macfoo 555-6480 1200/300 A sdace 555-3430 2400/1200/300 A sabafoo 555-2127 1200/300 C /foo/ { print $0 } Table 5: ç­›é€‰å‡º foo åŒ¹é…çš„è¡Œ fooey 555-1234 2400/1200/300 B foot 555-6699 1200/300 B macfoo 555-6480 1200/300 A sabafoo 555-2127 1200/300 C è¡¨æ ¼è‡ªå¢ id 0 å­—æ®µå åç§° 1 age å¹´é¾„ 2 bir å‡ºç”Ÿå¹´æœˆæ—¥ #+tblfm: $1=@#-1 C-c C-c to execute it\nLaTex å…¬å¼ $\\mbox{éœ€æ±‚çš„ä»·æ ¼å¼¹æ€§ç³»æ•°} = \\frac{\\mbox{éœ€æ±‚çš„å˜åŠ¨ç‡}}{\\mbox{ä»·æ ¼çš„å˜åŠ¨ç‡}}$ $$\\mbox{éœ€æ±‚çš„ä»·æ ¼å¼¹æ€§ç³»æ•°} = \\frac{\\mbox{éœ€æ±‚çš„å˜åŠ¨ç‡}}{\\mbox{ä»·æ ¼çš„å˜åŠ¨ç‡}}$$\n$$\\begin{aligned} \\cos 3\\theta \u0026amp; = \\cos (2 \\theta + \\theta) \\ \u0026amp; = \\cos 2 \\theta \\cos \\theta - \\sin 2 \\theta \\sin \\theta \\ \u0026amp; = (2 \\cos ^2 \\theta -1) \\cos \\theta - (2 \\sin \\theta\\cos \\theta ) \\sin \\theta \\ \u0026amp; = 2 \\cos ^3 \\theta - \\cos \\theta - 2 \\sin ^2 \\theta \\cos \\theta \\ \u0026amp; = 2 \\cos ^3 \\theta - \\cos \\theta - 2 (1 - \\cos ^2 \\theta )\\cos \\theta \\ \u0026amp; = 4 \\cos ^3 \\theta -3 \\cos \\theta \\end{aligned} $$\nOrg ä»£ç  ä»£ç ç‰‡æ®µå¼€å¯è¡Œå·ï¼Œä¿®æ”¹ `~/.emacs.d/.local/straight/repos/org/lisp/ox-html.el`\n(let* ((code-lines (split-string code \u0026quot;\\n\u0026quot;)) (code-length (length code-lines)) (num-fmt (and num-start (format \u0026quot;%%%ds \u0026quot; (format \u0026quot;%%%ds: \u0026quot; Java ä»£ç  /** * @param request è°ƒç”¨çš„è¯·æ±‚å‚æ•° * @param needLog true éœ€è¦è®°å½•æ—¥å¿— false ä¸è®°å½•æ—¥å¿— * @return */ protected NcApiResponse runApply(NcApiRequest request, Boolean needLog) { NcApiResponse ncApiResponse = null; try { final NcApiRequest ncApiRequest = executeBefore(request); ncApiResponse = executeGetRequest(ncApiRequest); } catch (Exception e) { afterExecute(needLog, e, request, ncApiResponse); if (e instanceof BizException) { throw new BizException(\u0026quot;NC æç¤º\u0026quot;, ((BizException) e).getErrorMsg(), e); } else { throw new BizException(\u0026quot;NC å¼‚å¸¸\u0026quot;, e.getMessage()); } } return ncApiResponse; } babel java List\u0026lt;Integer\u0026gt; a = Arrays.asList(1, 2); List\u0026lt;Integer\u0026gt; a = Arrays.asList(1, 2); List\u0026lt;Integer\u0026gt; a = Arrays.asList(1, 2); List\u0026lt;Integer\u0026gt; a = Arrays.asList(1, 2); List\u0026lt;Integer\u0026gt; a = Arrays.asList(1, 2); return a; C-c C-c to execute it, but export to html will fail when the babel java result generated.\nå›¾ç‰‡ å¼•ç”¨æœ¬åœ°å›¾ç‰‡ å¼•ç”¨ç½‘ç»œå›¾ç‰‡ dot graphviz dot\ndot sk\nplantuml plantuml with style css\nplantuml æ›¿æ¢åŸç”Ÿæ ·å¼\nDARKO RANGE/LIGHTORANGE/DARKBLUE/LIGHTBLUE/DARKRED/LIGHTRED/DARKGREEN/LIGHTGREEN\n!define LIGHTORANGE !includeurl C4-PlantUML/juststyle.puml plant uml ç³»ç»Ÿ Contex æ¶æ„å›¾\nplantuml æ›¿æ¢åŸç”Ÿæ ·å¼\nDARKORANGE/LIGHTORANGE/DARKBLUE/LIGHTBLUE/DARKRED/LIGHTRED/DARKGREEN/LIGHTGREEN\n!define LIGHTBLUE !includeurl C4-PlantUML/juststyle.puml æ³³é“å›¾\nplantuml htmlstyle\norg è½¬ Word pandoc -o ~/Desktop/out.docx ~/.doom.d/README.org æ’å…¥æ—¶é—´ C-c . æ’å…¥å½“å‰æ—¶é—´ \u0026lt;2023-02-25 Sat\u0026gt; K lask week J next week L next day ","permalink":"/posts/orgmodecss/","series":[],"tags":[],"title":"æ¨èä¸€æ¬¾ org mode å¯¼å‡º html çš„æ ·å¼"}]